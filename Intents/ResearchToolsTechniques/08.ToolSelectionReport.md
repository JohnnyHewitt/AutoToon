# 8. Tool Selection Report

**Goal**: Final recommendation: chosen tool(s), cost breakdown, pros/cons, architecture sketch for AI-driven pipeline. Decision document for Phase II.
**Est.**: ≤2 hours
**Dependencies**: 01–07

## Steps
- [x] Compile findings from all prior intents
- [x] Write final tool recommendation with rationale
- [x] Include cost breakdown (free/one-time purchase)
- [x] Document complete pipeline architecture: assets → storyboard → animation → sound
- [x] List known risks and open questions for Phase II

## Decision Document

---

### Animation Tool: Blender Grease Pencil

**Selected from:** OpenToonz, Synfig, Pencil2D, Krita, Blender GP, Toon Boom Harmony, Moho Pro, CACANi, TVPaint

**Why Blender GP:**
- Deepest Python API of all candidates — layers, frames, strokes, points, keyframes all scriptable
- Free, open source (GPL-3.0), massive community, actively developed
- 2D/3D hybrid capability (future flexibility)
- Headless rendering (`blender --background --python`)
- Production-proven: Unicorn Wars (feature film), Il Baracchino (Amazon series), Ronde de Nuit (noir short)

**Runners-up eliminated:**
- Toon Boom Harmony — subscription-only ($30/mo), closed source, proprietary formats
- Moho Pro — good Lua scripting, but closed source, no headless mode
- TVPaint — too organic/frame-by-frame, pytvpaint incompatible with v12

### Cost Breakdown

| Component | Cost |
|-----------|------|
| Blender | Free |
| Python / MCP tooling | Free |
| AI asset generation (Phase II) | API costs TBD (per-use) |
| AI TTS for dialogue (Phase II) | API costs TBD |
| Hosting (Phase III) | TBD |
| **Total for Phase II MVP** | **$0 for tooling** |

---

### Architecture

```
┌──────────────────────────────────────────────────┐
│        AutoToon Asset Manager (Web Tool)          │
│                                                  │
│  All assets in one system:                       │
│  ┌────────┐ ┌────────────┐ ┌───────────┐        │
│  │Scripts │ │Characters  │ │Animations │        │
│  │(Fountain)│ │(.blend rigs)│ │(Actions)  │        │
│  └────────┘ └────────────┘ └───────────┘        │
│  ┌────────┐ ┌────────────┐ ┌───────────┐        │
│  │Sounds  │ │Backgrounds │ │Storyboards│        │
│  │(wav/mp3)│ │(.blend)    │ │(scene data)│        │
│  └────────┘ └────────────┘ └───────────┘        │
│                                                  │
│  Tenant isolation: separate folders per customer │
│                                                  │
│  ┌────────────────────────────────────────────┐  │
│  │            MCP Server Layer                │  │
│  │                                            │  │
│  │  Asset tools:    asset.create/get/tag      │  │
│  │  Script tools:   script.parse/to_scenes    │  │
│  │  Board tools:    storyboard.gen_panels     │  │
│  │  Anim tools:     animation.assign_action   │  │
│  │                  blender.keyframe          │  │
│  │  Sound tools:    sound.place_on_timeline   │  │
│  │  Render tools:   blender.compose_scene     │  │
│  │                  blender.render            │  │
│  └─────────────────┬──────────────────────────┘  │
└────────────────────┼─────────────────────────────┘
                     │
                     │ Python API (bpy)
                     │
┌────────────────────┴─────────────────────────────┐
│             Blender (headless)                    │
│                                                  │
│  Grease Pencil    Armatures/Rigs    Actions/NLA  │
│  Keyframes        VSE (audio sync)  Rendering    │
│  Geometry Nodes   Asset Browser     Cameras      │
└──────────────────────────────────────────────────┘
```

### Blender Capabilities Summary

| Capability | Blender Feature | Python API |
|------------|----------------|------------|
| Character rigs | Armatures + GP objects | `bpy.data.armatures` |
| Reusable animations | Actions + NLA Editor | `bpy.data.actions`, `NlaTrack`, `NlaStrip` |
| Keyframe animation | Any property keyframeable | `obj.keyframe_insert()` |
| Tweening | Auto-interpolation between keyframes | `bpy.ops.gpencil.interpolate_sequence` |
| Lip sync | Shape keys or layer substitution | `bpy.data.shape_keys` |
| Scene composition | Scenes + cameras | `bpy.data.scenes`, `bpy.data.cameras` |
| Audio sync | VSE sound strips | `bpy.types.SoundSequence` |
| Asset management | Asset Browser (folder-based) | `bpy.types.AssetMetaData`, `AssetTag` |
| Rendering | EEVEE (fast) / Cycles | `bpy.ops.render.render()` |
| Procedural animation | Geometry Nodes | Node trees via API |

---

### What We Build in Phase II

| Component | Description |
|-----------|-------------|
| **Asset Manager** | Web tool — central hub for all asset types. CRUD, tagging, search, organization. Tenant-isolated folders. |
| **Script Parser** | Fountain → structured scene data. AI decomposes into scenes, panels, characters, actions, dialogue. |
| **Storyboard Engine** | Data layer that maps script → assets → panel compositions → Blender scenes. |
| **Animation Library** | Catalog of canned Actions (walk, talk, gesture, etc.). Semantic tagging. AI matches script actions to library. |
| **MCP Server** | Tool definitions for AI to call. Bridges asset manager to Blender. |
| **Blender Bridge** | Python adapter — accepts MCP tool calls, executes bpy commands in headless Blender. |

### What We DON'T Build (use existing)

| Component | Existing Solution |
|-----------|------------------|
| Animation rendering | Blender EEVEE/Cycles |
| Audio playback/sync | Blender VSE |
| Asset storage/linking | Blender Asset Browser |
| Keyframe interpolation | Blender animation system |
| AI image generation | External APIs (Stable Diffusion, DALL-E, etc.) |
| AI TTS | External APIs (ElevenLabs, Bark, Coqui) |

---

### Known Risks

1. **Blender GP fill tool quirks** — documented issues with fills in 3D space. May need workarounds for clean cartoon fills.
2. **Headless Blender stability** — long-running headless sessions may have memory/stability issues at scale.
3. **Character rigging complexity** — initial rig creation for new characters requires significant work. Need templates/automation.
4. **Style consistency** — AI-generated assets need to match across a project. Requires careful prompt engineering or fine-tuning.
5. **GP 3.0 migration** — Grease Pencil data model changed in Blender 4.x. API may continue evolving.

### Open Questions for Phase II

1. What web framework for the asset manager? (Python — Django/FastAPI likely)
2. How to handle concurrent Blender instances per tenant?
3. What AI models for asset generation? (style-consistent characters, backgrounds)
4. Lip sync approach — phoneme detection → shape key mapping?
5. How much of the storyboard-to-scene pipeline can be fully automated vs. human-in-the-loop?

---

## Outcome
- **Actual Time**: ~30 min
- **Result**: Decision document complete. Blender GP + custom asset manager + MCP architecture. $0 tooling cost for Phase II MVP. Clear build list and risk register.
- **Follow-ups**: Run `/brain` for Phase II to break down the build into intents.
